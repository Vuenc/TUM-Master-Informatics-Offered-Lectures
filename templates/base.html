{% import 'macros.jinja' as macros %}
<!DOCTYPE html>
<html lang='en'>
<head>
  {% block head %}
  <meta charset="utf-8">
  <title>{% block title %}{{ title }}{% endblock title %}</title>
  <style>
    {{ macros.indented_include("style.css", 4) }}
  </style>
  {% endblock head %}
</head>

<body>
  <div class="main-container">
    <h1>{{ title }}</h1>

    <div style="text-align: justify;">
      <p>
        This is a list of lectures grouped by area with availability data, which as far as I know is not provided by TUM
        elsewhere in a convenient format. I hope it will be helpful to you!
      </p>

      {% if with_rare_and_new_courses %}
      <p>
        ðŸ’Ž: Rare course (not offered in the last two semesters)<br>
        ðŸŒŸ: New course (offered for the first time)
      </p>
      {% endif %}

      <p>
        <b>Disclaimer:</b> This site is non-official and automatically generated by fetching the data from the
        curriculum tree view and the data from the Courses tab in TUM online, and merging
        it based on course page URL. It can contain errors, or courses can be missing, for example if there is a bug in
        my code (has happened before), or if a new course was not yet present in the tree view at the time this list was
        created. Use with care (and please notify me if you find any errors).
      </p>
    </div>
    
    {{ macros.indented_include("github_and_kofi.html", 4) }}

    {%- for area, courses_in_area in courses_by_area %}

    <h3>{{ area }}</h3>
    <table>
      <thead>
        <tr style="text-align: right;">
          <th>ID</th>
          <th class="titleheader">Title</th>
          <th>Credits</th>
          {% for key in extra_column_keys %}
          <th>{{ key }}</th>
          {% endfor %}
          {% if include_last_offered %}
          <th>Last offered</th>
          {% endif %}
        </tr>
      </thead>

      <tbody>
        {% for course in courses_in_area
        |sort(attribute='title')
        |sort(attribute='term_id', reverse=true) %}
        <tr>
          <td>
            {{- course.course_code }}
            {%- if course.equivalent_courses|length == 1 -%}
            &nbsp;<span title="New course: offered for the first time!" class="tagIcon">ðŸŒŸ</span>
            {%- endif -%}
            {%- if course|is_rare_course -%}
            &nbsp;<span title="Rare course: last offered in {{ course|course_last_offered_in }}" class="tagIcon">ðŸ’Ž</span>
            {%- endif -%}
          </td>
          <td><a href="{{ course.url }}">{{ course.title }}</a></td>
          <td>{{ course.credits }}</td>
          {% for value_extractor in extra_column_extractors %}
          <td>{{ value_extractor(course) }}</td>
          {% endfor %}
          {% if include_last_offered %}
          <td>{{ course.term_name }}</td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endfor %}
  </div>
</body>
</html>
